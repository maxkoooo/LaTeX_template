% preamble
\ProvidesPackage{preamble}
\RequirePackage{geometry} % page layout

\usepackage{fancyhdr}   % fancy pages (mostly for page numbering)
\usepackage{pdfpages}
\usepackage{graphicx}
\usepackage[dvipsnames]{xcolor}
\usepackage{tcolorbox}
\usepackage{moresize}   % additional font sizes
\usepackage{textcomp}   % additional characters
\usepackage{tocloft}    % makes table of contents nice
\usepackage[nottoc]{tocbibind}  % adds bibliography to table of contents
\usepackage{titlesec}   % custom section titles
\usepackage{multirow}   % multirow tables
\usepackage{array}
\usepackage{tabularray}
\usepackage{hhline}
\usepackage{float}  % for H placement
\usepackage{parskip}
% \usepackage{indentfirst}    % indents first paragraph
\usepackage{xspace} % for spacing after macros
\usepackage{caption}
\usepackage[super]{nth}
\usepackage{xfrac}
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage{microtype}
\usepackage{hyperref}
\usepackage[noabbrev, capitalise, nameinlink]{cleveref}
\usepackage[separate-uncertainty=true]{siunitx}    % si units and number formatting
\usepackage{tikz}
\usepackage[siunitx, american, straightvoltages]{circuitikz}
\usepackage{steinmetz}  % for phasor diagrammes
\usepackage{listings}
\usepackage{lipsum}

% font stuff
\usepackage{fontspec}
\usepackage{bold-extra}

% title page
\usepackage{nott-titlepage}

% table of contents settings
\renewcommand{\cfttoctitlefont}{\Huge\textbf}
\renewcommand{\cftaftertoctitleskip}{30pt}
\renewcommand{\cftsubsecdotsep}{\cftnodots}
\renewcommand{\cftsubsubsecdotsep}{\cftnodots}
\renewcommand{\cftbeforesubsecskip}{10pt}
\renewcommand{\cftbeforesubsubsecskip}{10pt}
\renewcommand{\cftbeforesecskip}{20pt}
\tocloftpagestyle{fancy}
\newcommand*{\nsection}[1]{ % use this command to have unnumbered sections show up in the table of contents
    \section*{#1}
    \addcontentsline{toc}{section}{#1}
}

% set header and footer + page numbering
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\rfoot{\large\thepage}    % numbering on the right

% table settings
\setlength{\tabcolsep}{0.5em}
\renewcommand{\arraystretch}{1.25}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{M}[1]{>{\centering\arraybackslash}m{#1}}
\renewcommand{\thetable}{\Roman{table}}

% caption settings
\counterwithin{figure}{section}

% listing settings
\usepackage{matlab-prettifier}
\input{listings_styles/c++_listings}

% hyperref settings
\hypersetup{
    colorlinks = true,
    urlcolor = {blue!80!black},
    citecolor = black,
    linkcolor = black,
    menucolor = black,
    filecolor = black,
}

%=+={ macros }=+=%
% prints formatted matlab
\newcommand{\MATLAB}{\textsc{Matlab}\xspace}

% prints general figure
\newcommand{\fig}[5]{
    \begin{figure}[#5]
        \centering
        \includegraphics[width=#1\textwidth]{figures/#2}
        \caption{#3}
        \label{fig:#4}
    \end{figure}
}

% prints figure with box
\newcommand{\figbox}[5]{
    \begin{figure}[#5]
        \centering
        \fbox{\includegraphics[width=#1\textwidth]{figures/#2}}
        \caption{#3}
        \label{fig:#4}
    \end{figure}
}

\newcommand{\code}[1]{\tcbox[colback=Gray!20,
                             on line,
                             boxrule=0pt,
                             boxsep=-0.25em,
                             left=0.5em,
                             right=0.5em,
                            ]{\texttt{#1}}\xspace}

\newcommand{\maketable}[4]{
\begin{table}[#4]
    \centering
    
    \textsc{\cref{table:#3}} \\
    \vspace{-0.5ex}
    
    \caption*{\textsc{#2}}
    \vspace{0.5ex}
    
    #1
    
    \vspace{0.5ex}
    
    \captionlistentry{}
    \label{table:#3}
\end{table}
}